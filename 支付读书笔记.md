支付是社会经济活动所引起的货币债权的转移过程，包括三个基本过程：交易、清分和结算。这三个基本过程被称为支付的三原基。



清分（Clearing）指债权人和债务人的相关金融机构之间按照约定的规则，完成支付指令的交换，并计算出待清偿债权、债务结果，也就是支付过程参与方算费的过程。清分是结算的数据准备阶段。



在清分的过程中，需要确保账务信息数据准确、账务对平，从而为后续债权债务提供数据支撑。这个过程包括交易信息落地和状态流转、将数据汇总后根据日切时间（上一个工作日结束的时间点）打包批次、差账异常数据处理、计算结算债权债务结果等。



支付请求进来后，系统需要从支付成本、支付体验、支付风险、支付成功率等维度以及灾备处理方面进行综合考虑，以保证实现交易处理的最优解。比如，在接入多个支付通道后，要考虑该怎么分配流量请求，于是有了路由系统；当银行、卡组织或者第三方支付愿意贴补营销费用时，要考虑如何扣减和展示，于是有了营销系统；当一笔订单有多个商品或者多种支付方式时，要考虑对于组合订单或者组合支付如何分账，于是有了订单系统、分账系统；当用户的一些支付要素已经保存时，在保证安全的前提下，要考虑用户再次支付时如何进行反显或者省略输入以避免用户重复填写，进而提升转化率，于是有了常用卡系统。



商户和通道多了后，要考虑如何高效、及时、准确地处理对账问题。人力的增长赶不上业务的增长，系统从最初的手工拉取账单变成系统自动生成系统，从每月对账变成每日对账，开始有了各种各样的系统来处理账单，比如计费系统、对账系统、结算系统、会计系统、差错处理系统、清分系统、对账文件服务等。这些系统一起构成了清结算系统，于是有了清算核心层。



卡基是支付最初的形态，无论是早期线下刷卡还是网银都属于卡基。账基是以账户为基础的支付方式，一个账户可以绑定多张卡。微信支付、支付宝都属于账基。



对账单支持哪些获取方式？对账单的获取方式有以下三种。

- 登录后台下载。通道方为商户开设后台账号和密码，商户登录后进行人工对账单下载或导出。
- 邮件推送。商户向收单机构（通道方）提供邮箱地址，收单机构按照规定定时推送。
- FTP下载，这是推荐的方式。随着接入通道增多，人工下载变得费时费力，而FTP下载可以自动完成，实现加活不加人，这是系统轻量化运营中重要的一环。FTP下载根据对象关系不同可分成两种：一种是商户主动去收单机构下载，一种是由收单机构主动推送到商户FTP地址。不管是哪种，在接入的时候，均会涉及地址、用户名、密码、目录、IP白名单。如果是商户去收单机构下载，需要收单机构向商户提供下载的目标地址、用于身份允许的用户名、密码、下载的目录地址；而商户需要给收单机构对应的IP地址，以事先配置到收单机构白名单里。如果是收单机构主动推送到商户，则反过来，由商户向收单机构提供下载的目标地址、用于身份允许的用户名、密码、推送的目录地址；而收单机构需要给商户对应的IP地址，以事先配置到商户的白名单里。



在支付领域，我们这么定义路由：路由系统是支付核心系统，对商户支付页面进行管理与输出、根据商户需求及通道特性基础对交易进行处理，并在此基础上对支付中的异常情况进行支付灾备处理。



另外，如果是网络掉线等原因，在通道层面有正常的补偿机制进行处理，不需要调用重试服务。



正如上面的例子中所说，在清结算工作中，产品经理需要充分理解对账文件含义，清楚定义所需字段，并为开发人员解读，才能尽可能避免对账失误。通过明确对账文件规范和要求、下载对账文件、对账文件解析这三步，我们便能保证成功获取支付通道对账单，落地所需数据，为后续对账做好准备。



此外，我们还了解了对账是轧账和平账的过程。轧账和平账的目的是进行交易核算，将账单对平，对于不能核对匹配的交易，进行补单或者退款等差账处理方式，最终实现账单对平。

[支付方法论-王伟-微信读书 (qq.com)](https://weread.qq.com/web/bookDetail/63b324007224e31963b206e)